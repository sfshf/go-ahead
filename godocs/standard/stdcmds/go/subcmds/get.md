
[Add dependencies to current module and install them](https://golang.google.cn/cmd/go/#hdr-Add_dependencies_to_current_module_and_install_them)

##### 一、用法

```

go get [-d] [-t] [-u] [-v] [-insecure] [build flags] [packages]

```

##### 二、get命令说明

`get命令`解析并将依赖项添加到当前开发模块，然后构建并安装它们。


**第一步，是解析将要被添加的依赖项：**

对于每个指名的包或包模式，`get命令`必须决定使用对应模块的哪个版本。默认情况下，`get命令`会查找最新被标记的发布版本，比如`v0.4.5`或`v1.2.3`。如果没有被标记的发布版本，`get命令`将查找最新被标记的预发布版本，如`v0.0.1-pre1`。如果根本没有被标记的版本，`get命令`会查找最新的代码提交（commit）。如果模块没有被需要（required）了一个更新的版本（例如：比最新发布版本更新的预发布版本），`get命令`将使用它要找的版本；否则，`get命令`将使用当前被需要的(required)版本。

可以为包参数添加`@version`后缀来复写默认版本选项，例如：`go get golang.org/x/text@v0.3.0`。版本可能只是一个前缀，例如`@v1`，这表示获取`v1`开头的可被获取到的最新版本。使用`go help modules`查看`Module queries`专题，获取全面的搜索语法。

对于存储在源码控制仓库中的模块，版本后缀可以是某次代码提交的hash码、代码分支识别码或者其它源码控制系统能识别的语法，例如`go get golang.org/x/text@master`。注意，名称与其他模块查询语法重叠的分支是不能被显式选择的。例如，`@v2`后缀表示以`v2`开头的版本中最新的一个，而不表示被命名为`v2`的分支。

如果被考虑引用的模块已经是当前开发模块的依赖项，那么`get命令`将其更新为所需的版本。指定一个比当前所引用模块的版本更早的一个版本也是有效的，而且会降低依赖性。版本后缀`@none`表示应该完全删除依赖项，根据需要降低或删除依赖项的模块。

版本后缀`@latest`显式地请求根据给定路径命名的模块的最新次要版本。后缀`@upgrade`与`@latest`类似，然而，如果该依赖模块已经被引用或该依赖模块是比最新发布版本更新的预发布版本，则`@latest`不会降级该依赖模块。后缀`@patch`会请求最新的补丁发布版本:最新发布的版本，其主版本号和次版本号与当前引用的版本号相同。与`@upgrade`一样，`@patch`不会降低已经被引用为更新版本的模块的依赖等级。如果路径没有被引用，则`@upgrade`和`@patch`等同于`@latest`。

尽管`get命令`默认使用包含指定包的模块的最新版本，但它不会使用该模块依赖项的最新版本；相反地，它更优先使用该模块请求的指定依赖项版本。例如,如果`最新版本的模块A`引用了`模块B v1.2.3`,而`模块B v1.2.4和v1.3.1`也可用,那么`go get A`将引用`最新版本的模块A`，然后会引用`模块A`要引用的`模块B v1.2.3`(如果对一个特定的模块因有多个引用而引起争议,那么`go get`解析这些引用，选取最大的引用版本。)

`-t`标志指示`get命令`检索一下需要构建测试的模块，构建的测试是有关命令行上指定的的包的。

`-u`标志指示`get命令`更新模块，促使在命令行中指名的包的依赖项更新到可获得的较新的次要发布版或补丁发布版。继续前面的示例，`go get -u A`将获取使用了`模块B v1.3.1`(而不是`模块B v1.2.3`)的最新的`模块A`。如果模块B引用了模块C，而模块A构建包时与模块C没有任何包(不包括测试)的直接关联，那么模块C将不会更新。

`-u=patch`标志(而不是`-u patch`)也指示`get命令`更新依赖项，但是更改默认值以选择补丁发布版。继续前面的示例，`go get -u=patch A@latest`将获取使用了`模块B v1.2.4`(而不是`模块B v1.2.3`)的最新的`模块A`，而`go get -u=patch A`将使用模块A的补丁发布版。

当`-t`和`-u`标志一起使用时，`get命令`也会更新测试依赖项。

通常，添加一个新的依赖项可能需要升级现有的依赖项来保持一个起作用的构建，`go get`会自动完成这一任务。类似地，降低一个依赖项的级别可能需要降低其他依赖项的级别，而`go get`也会自动做到这一点。

`-insecure`标志允许从存储库获取数据并使用HTTP等不安全模式解析自定义域。谨慎使用。


**第二步，是下载（如果需要的话）、构建和安装指名的包：**

如果一个参数命名的是一个模块而不是一个包(因为模块的根目录中没有Go源代码)，那么该参数将跳过安装步骤，而不会导致构建失败。例如：即使导入路径`golang.org/x/perf`下没有对应的代码，`go get golang.org/x/perf`仍会成功运行。

注意：包模式是被允许的，并且包模式会在解析模块版本之后被扩展开来。例如：`go get golang.org/x/perf/cmd/...`会添加最新的`golang.org/x/perf`包，并且然后在最新的版本下安装命令。

`-d`标志指示`get命令`去下载构建指定包所需的源代码，包括下载必要的依赖项，但不构建和安装它们。

在没有包参数的情况下，`go get`应用于当前目录中的go包(如果有的话)。特别是，`go get -u`和`go get -u=patch`更新了包的所有依赖项。没有包参数，也没有`-u`标志， `go get`与`go install`效果一样；`go get -d`与`go list`效果一样。

使用`go help modules`查看更多关于模块的信息。

使用`go help packages`查看更多关于包的信息。

本文描述了`get命令`使用模块管理源代码和依赖项的行为。如果`go命令`在`GOPATH`模式下运行，`get命令`的标志和效果的细节就会改变，`go help get`也是如此。详见`go help modules`和`go help gopath=get`。

更多信息参考[`go build`](build.md)，[`go install`](install.md)，[`go clean`](clean.md)，[`go mod`](mod.md)。
